import os
import sys
import subprocess
import json


class ProductTopAttributesDataPrep:
   
    def execHiveCheck(self, query):
        cmd = "/usr/local/bin/hive"
        option1 = '-e'
        option2 = query
        command = [cmd, option1, option2]
        print '[COMMAND]:  ', ", ".join(command)
        result = ''
        try:
            result = subprocess.check_output(command)
        except Exception as e:
            print 'ERROR: Exception thrown: Hive query failed', e
            #sys.exit(1)
        return result
    
    def insertData(self): 
        product_id = '6HSKTDWAJEW9'   
        source = 'BRAAVOS'    
        updated_at1 = '1510207830456'  
        updated_at2 = '1510207830656'  
        product_attributes1 = '{ "pcf" : {"all_rhids":{"properties":{"attributeId":"rhid","taxonomy_version":"~draft","attributeName":"Site Taxonomy","taxonomy":"rhid-dotcom","source":"BRAAVOS","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","status":"VERIFIED"},"values":[{"path_id":"[\"40000\",\"45000\",\"45004\",\"45121\",\"45365\"]","id":"45365","locale":"en_US","value":"OFFICE PRODUCTS AND SCHOOL SUPPLY MISC L4","tag_source":"rule","path_str":"[\"EVERYDAY LIVING\",\"OFFICE PRODUCTS AND SCHOOL SUPPLY\",\"OFFICE PRODUCTS AND SCHOOL SUPPLY MISC L2\",\"OFFICE PRODUCTS AND SCHOOL SUPPLY MISC L3\",\"OFFICE PRODUCTS AND SCHOOL SUPPLY MISC L4\"]"}]},"primary_shelf":{"properties":{"attributeId":"shelf","added":"Wed Nov 08 22:10:29 PST 2017","attributeName":"Primary Shelf","source":"BRAAVOS","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","status":"VERIFIED"},"values":[{"all_paths_str":"[[\"Home Page\",\"Home\",\"Decor\",\"Art & Wall Decor\",\"Wall Decor\"]]","path_id":"[\"0\",\"4044\",\"133012\",\"1045881\",\"922699\"]","all_paths_id":"[[\"0\",\"4044\",\"133012\",\"1045881\",\"922699\"]]","taxonomy_version":"~draft","id":"922699","taxonomy":"site-dotcom","locale":"en_US","value":"Wall Decor","tag_source":"normalization","path_str":"[\"Home Page\",\"Home\",\"Decor\",\"Art & Wall Decor\",\"Wall Decor\"]"}]},"alternate_shelves":{"properties":{"attributeId":"alternate_shelves","attributeName":"Alternate Shelves","source":"MARKETPLACE_PARTNER","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R"},"values":[{"isPrimary":"true","locale":"en_US","value":"922699"}]},"item_class_id":{"properties":{"attribute_type":"STRING","attributeName":"Item Class ID","source":"BRAAVOS","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9"},"values":[{"locale":"en_US","value":"1","tag_source":"rule"}]},"primary_category_path":{"properties":{"attributeId":"primary_category_path","attributeName":"Primary Category Path","source":"MARKETPLACE_PARTNER","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R"},"values":[{"isPrimary":"true","locale":"en_US","value":"0:4044:133012:1045881:922699"}]},"product_url_text":{"properties":{"fromPcp":"false","added":"Thu Nov 09 06:10:29 UTC 2017","isMultiValued":"false","taxonomy_version":"urn:taxonomy:pcs2.0","attribute_type":"STRING","source":"braavos","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","attributeId":"86412","requestId":"reingest1-dab1aa83-efd4-48ef-a282-7b7e88f4dbdf","org_id":"0ceec947-5172-46e4-8dc4-8e37b4ffde80","isMarketAttribute":"true","attributeName":"Product URL Text","updated":"Thu Nov 09 06:10:29 UTC 2017"},"values":[{"isPrimary":"true","display_attr_name":"url_text_key","locale":"en_US","value":"/ip/NMC-Signs-Dl76R-Hot-Dot-Placard-Sign-10-75-X-10-75-Rigid-Plastic-050/765417231","source_key":"url_text_key","source_value":"/ip/NMC-Signs-Dl76R-Hot-Dot-Placard-Sign-10-75-X-10-75-Rigid-Plastic-050/765417231"}]},"primary_shelf_id":{"properties":{"attributeId":"primary_shelf_id","attributeName":"Primary Shelf ID","source":"BRAAVOS","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9"},"values":[{"isPrimary":"true","locale":"en_US","value":"922699"}]},"char_primary_category_path":{"properties":{"attributeId":"char_primary_category_path","attributeName":"Character Primary Category Path","source":"MARKETPLACE_PARTNER","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R"},"values":[{"isPrimary":"true","locale":"en_US","value":"Home Page/Home/Decor/Art & Wall Decor/Wall Decor"}]},"product_long_description":{"properties":{"attributeId":"84122","fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-689475a0-ccfa-4b36-8af2-8ff6c89ba6f4","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","taxonomy_version":"urn:taxonomy:pcs2.0","attributeName":"Product Long Description","source":"mp","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R","updated":"Fri Sep 22 05:28:44 UTC 2017","content_lifecycle_status":"ACTIVE"},"values":[{"isPrimary":"true","display_attr_name":"Product Long Description","locale":"en_US","value":"<ul><li>MADE IN THE USA</li><li>Name:HOT DOT PLACARD SIGN</li><li>Height (In): 10.75</li><li>Width (In): 10.75</li><li>Material: RIGID PLASTIC .050</li><li>Legend: HOT</li></ul>","source_key":"long_description","source_value":"<ul><li>MADE IN THE USA</li><li>Name:HOT DOT PLACARD SIGN</li><li>Height (In): 10.75</li><li>Width (In): 10.75</li><li>Material: RIGID PLASTIC .050</li><li>Legend: HOT</li></ul>"}]},"wmt_category":{"properties":{"fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-dab1aa83-efd4-48ef-a282-7b7e88f4dbdf","org_id":"0ceec947-5172-46e4-8dc4-8e37b4ffde80","taxonomy_version":"urn:taxonomy:pcs2.0","attributeName":"WMT Category","source":"braavos","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","updated":"Thu Nov 09 06:10:29 UTC 2017","isFacet":"true"},"values":[{"isFacetValue":"true","locale":"en_US","value":"Wall_Decor"}]},"facet_product_type":{"properties":{"taxonomy_version":"urn:taxonomy:pcs2.0","attributeName":"Facet Product Type","source":"MARKETPLACE_PARTNER","isFacet":"true"},"values":[{"isFacetValue":"true","facet_version":"1.1","locale":"en_US","value":"Plaques & Signs"}]},"brand":{"properties":{"fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","taxonomy_version":"urn:taxonomy:pcs2.0","source":"mp","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R","multiselect":"N","attributeId":"10848","requestId":"reingest1-689475a0-ccfa-4b36-8af2-8ff6c89ba6f4","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","attributeName":"Brand","updated":"Fri Sep 22 05:28:44 UTC 2017","isFacet":"true","content_lifecycle_status":"ACTIVE"},"values":[{"isPrimary":"true","display_attr_name":"Brand","locale":"en_US","value":"NMC","source_key":"brand","source_value":"NMC"},{"isFacetValue":"true","facet_version":"1.1","locale":"en_US","value":"NMC"}]},"display_status":{"properties":{"attributeId":"94989","fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-689475a0-ccfa-4b36-8af2-8ff6c89ba6f4","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","taxonomy_version":"urn:taxonomy:pcs2.0","isMarketAttribute":"true","attributeName":"Display Status","source":"mp","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R","updated":"Fri Sep 22 05:28:44 UTC 2017","content_lifecycle_status":"ACTIVE"},"values":[{"isPrimary":"true","display_attr_name":"Display Status","locale":"en_US","value":"STAGING","source_key":"display_status","source_value":"STAGING"}]},"gtin":{"properties":{"multiselect":"N","attributeId":"-1","fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-dab1aa83-efd4-48ef-a282-7b7e88f4dbdf","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","taxonomy_version":"urn:taxonomy:pcs2.0","attributeName":"GTIN","source":"braavos","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","updated":"Thu Nov 09 06:10:29 UTC 2017","content_lifecycle_status":"ACTIVE","generated_from_matching":"true"},"values":[{"locale":"en_US","source_key":"gtin","value":"00887481042145","display_attr_name":"GTIN","source_value":"00887481042145","isPrimary":"true"}]},"rh_path":{"properties":{"attributeId":"94969","isMultiValued":"false","taxonomy_version":"version","isMarketAttribute":"true","attribute_type":"STRING","attributeName":"RH Path","taxonomy":"pcs","display_attr_name":"rh_path","source":"BRAAVOS","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9"},"values":[{"isPrimary":"true","display_attr_name":"rh_path","locale":"en_US","value":"40000:45000:45004:45121:45365"}]},"item_id":{"properties":{"attributeId":"-1","fromPcp":"false","generated_by":"Qarth","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-dab1aa83-efd4-48ef-a282-7b7e88f4dbdf","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","taxonomy_version":"urn:taxonomy:pcs2.0","attributeName":"ITEM_ID","source":"braavos","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","updated":"Thu Nov 09 06:10:29 UTC 2017","content_lifecycle_status":"ACTIVE","generated_from_matching":"true"},"values":[{"isPrimary":"true","display_attr_name":"ITEM_ID","locale":"en_US","value":"765417231","source_key":"item_id","source_value":"765417231"}]},"upc":{"properties":{"multiselect":"N","attributeId":"-1","fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-dab1aa83-efd4-48ef-a282-7b7e88f4dbdf","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","taxonomy_version":"urn:taxonomy:pcs2.0","attributeName":"UPC","source":"braavos","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","updated":"Thu Nov 09 06:10:29 UTC 2017","content_lifecycle_status":"ACTIVE","generated_from_matching":"true"},"values":[{"locale":"en_US","source_key":"upc","value":"887481042145","display_attr_name":"UPC","source_value":"887481042145","isPrimary":"true"}]},"product_pt_family":{"properties":{"added":"Thu Mar 16 11:59:24 UTC 2017","taxonomy_version":"~draft","taxonomy":"pcs","source":"braavos","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","orgId":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","attributeId":"product_pt_family","org_id":"0ceec947-5172-46e4-8dc4-8e37b4ffde80","requestId":"PIG-BF16B8FEBD1B4DE393CCEB1079FF51BB@ARABAQA/765417231/14","attributeName":"Product PT Family","classification_type":"PRODUCT_TYPE","updated":"Mon Oct 16 06:56:05 UTC 2017","status":"VERIFIED"},"values":[{"id":"home_decor_pcs","locale":"en_US","value":"Home Decor","tag_source":"model_guess"}]},"product_name":{"properties":{"multiselect":"N","attributeId":"84123","fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-689475a0-ccfa-4b36-8af2-8ff6c89ba6f4","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","taxonomy_version":"urn:taxonomy:pcs2.0","attributeName":"Product Name","source":"mp","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R","updated":"Fri Sep 22 05:28:44 UTC 2017","content_lifecycle_status":"ACTIVE"},"values":[{"isPrimary":"true","display_attr_name":"Product Name","locale":"en_US","value":"NMC Signs Dl76R, Hot Dot Placard Sign, 10.75 X 10.75, Rigid Plastic .050","source_key":"product_name","source_value":"NMC Signs Dl76R, Hot Dot Placard Sign, 10.75 X 10.75, Rigid Plastic .050"}]},"shelf_description":{"properties":{"fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","taxonomy_version":"urn:taxonomy:pcs2.0","source":"mp","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R","multiselect":"N","attributeId":"-2126304598","requestId":"reingest1-689475a0-ccfa-4b36-8af2-8ff6c89ba6f4","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","isMarketAttribute":"true","attributeName":"Shelf Description","updated":"Fri Sep 22 05:28:44 UTC 2017","content_lifecycle_status":"ACTIVE"},"values":[{"isPrimary":"true","display_attr_name":"Shelf Description","locale":"en_US","value":"<ul><li>Items ship from manufacturer in 2 days</li><li>Made in the USA</li><li>Hot Dot Placard Sign</li></ul>","source_key":"shelf_description","source_value":"<ul><li>Items ship from manufacturer in 2 days</li><li>Made in the USA</li><li>Hot Dot Placard Sign</li></ul>"}]},"product_tax_code":{"properties":{"fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","taxonomy_version":"urn:taxonomy:pcs2.0","source":"mp","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R","multiselect":"N","attributeId":"84126","isOfferAttribute":"true","requestId":"reingest1-689475a0-ccfa-4b36-8af2-8ff6c89ba6f4","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","attributeName":"Product Tax Code","updated":"Fri Sep 22 05:28:44 UTC 2017","content_lifecycle_status":"ACTIVE"},"values":[{"isPrimary":"true","display_attr_name":"Product Tax Code","locale":"en_US","value":"2038711","source_key":"product_tax_code","source_value":"2038711"}]},"condition":{"properties":{"multiselect":"N","attributeId":"10314","fromPcp":"false","added":"Fri Sep 22 17:06:12 UTC 2017","requestId":"reingest1-dab1aa83-efd4-48ef-a282-7b7e88f4dbdf","org_id":"0ceec947-5172-46e4-8dc4-8e37b4ffde80","taxonomy_version":"urn:taxonomy:pcs2.0","backfill":"true","attributeName":"Condition","source":"braavos","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","updated":"Thu Nov 09 06:10:29 UTC 2017"},"values":[{"locale":"en_US","source_key":"condition","value":"New","display_attr_name":"Condition","source_value":"New","tag_source":"model_predictions:ae2","isPrimary":"true"}]},"all_shelves":{"properties":{"attributeId":"shelf","added":"Wed Nov 08 22:10:29 PST 2017","rule_changed":"N","attributeName":"All Shelves","source":"BRAAVOS","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","status":"VERIFIED"},"values":[{"all_paths_str":"[[\"Home Page\",\"Home\",\"Decor\",\"Art & Wall Decor\",\"Wall Decor\"]]","path_id":"[\"0\",\"4044\",\"133012\",\"1045881\",\"922699\"]","all_paths_id":"[[\"0\",\"4044\",\"133012\",\"1045881\",\"922699\"]]","taxonomy_version":"~draft","id":"922699","taxonomy":"site-dotcom","locale":"en_US","value":"Wall Decor","tag_source":"normalization","path_str":"[\"Home Page\",\"Home\",\"Decor\",\"Art & Wall Decor\",\"Wall Decor\"]"}]},"product_type":{"properties":{"added":"Thu Mar 16 11:59:24 UTC 2017","taxonomy_version":"~draft","taxonomy":"pcs","source":"braavos","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","orgId":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","attributeId":"product_type","org_id":"0ceec947-5172-46e4-8dc4-8e37b4ffde80","requestId":"PIG-BF16B8FEBD1B4DE393CCEB1079FF51BB@ARABAQA/765417231/14","attributeName":"Product Type","classification_type":"PRODUCT_TYPE","updated":"Mon Oct 16 06:56:05 UTC 2017","status":"VERIFIED"},"values":[{"idPath":"[[\"home_and_garden\",\"home_decor_pcs\",\"1916\"]]","charPath":"[[\"Home & Garden\",\"Home Decor\",\"Plaques & Signs\"]]","id":"1916","locale":"en_US","value":"Plaques & Signs","tag_source":"model_guess"}]},"material":{"properties":{"attributeId":"10312","fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-689475a0-ccfa-4b36-8af2-8ff6c89ba6f4","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","taxonomy_version":"urn:taxonomy:pcs2.0","attributeName":"Material","source":"mp","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R","updated":"Fri Sep 22 05:28:44 UTC 2017","content_lifecycle_status":"ACTIVE"},"values":[{"materialValue":"RIGID PLASTIC .050","isPrimary":"true","display_attr_name":"Material","locale":"en_US","value":"RIGID PLASTIC .050","source_key":"material","source_value":"RIGID PLASTIC .050"}]},"manufacturer_part_number":{"properties":{"multiselect":"N","attributeId":"10336","fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-689475a0-ccfa-4b36-8af2-8ff6c89ba6f4","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","taxonomy_version":"urn:taxonomy:pcs2.0","attributeName":"Manufacturer Part Number","source":"mp","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R","updated":"Fri Sep 22 05:28:44 UTC 2017","content_lifecycle_status":"ACTIVE"},"values":[{"isPrimary":"true","display_attr_name":"Manufacturer Part Number","locale":"en_US","value":"DL76R","source_key":"manufacturerpartnumber","source_value":"DL76R"}]},"offer_lifecycle_status":{"properties":{"fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-689475a0-ccfa-4b36-8af2-8ff6c89ba6f4","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","source":"mp","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R","updated":"Fri Sep 22 05:28:44 UTC 2017"},"values":[{"display_attr_name":"offer_lifecycle_status","locale":"en_US","value":"ACTIVE"}]},"product_short_description":{"properties":{"multiselect":"N","attributeId":"84128","fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-689475a0-ccfa-4b36-8af2-8ff6c89ba6f4","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","taxonomy_version":"urn:taxonomy:pcs2.0","attributeName":"Short Description","source":"mp","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R","updated":"Fri Sep 22 05:28:44 UTC 2017","content_lifecycle_status":"ACTIVE"},"values":[{"isPrimary":"true","display_attr_name":"Short Description","locale":"en_US","value":"Hot substances can cause serious burns when they come in contact with ones skin. Prevent an accident by labeling designated vehicles carrying hot substances with this placard sign.","source_key":"short_description","source_value":"Hot substances can cause serious burns when they come in contact with ones skin. Prevent an accident by labeling designated vehicles carrying hot substances with this placard sign."}]},"reporting_hierarchy":{"properties":{"attributeId":"rhid","taxonomy_version":"~draft","attributeName":"Site Taxonomy","taxonomy":"rhid-dotcom","source":"BRAAVOS","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","status":"VERIFIED"},"values":[{"is_updated":"false","path_id":"[\"40000\",\"45000\",\"45004\",\"45121\",\"45365\"]","id":"45365","locale":"en_US","value":"OFFICE PRODUCTS AND SCHOOL SUPPLY MISC L4","tag_source":"rule","path_str":"[\"EVERYDAY LIVING\",\"OFFICE PRODUCTS AND SCHOOL SUPPLY\",\"OFFICE PRODUCTS AND SCHOOL SUPPLY MISC L2\",\"OFFICE PRODUCTS AND SCHOOL SUPPLY MISC L3\",\"OFFICE PRODUCTS AND SCHOOL SUPPLY MISC L4\"]"}]},"product_category":{"properties":{"added":"Thu Mar 16 11:59:24 UTC 2017","taxonomy_version":"~draft","taxonomy":"pcs","source":"braavos","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","orgId":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","attributeId":"segment","org_id":"0ceec947-5172-46e4-8dc4-8e37b4ffde80","requestId":"PIG-BF16B8FEBD1B4DE393CCEB1079FF51BB@ARABAQA/765417231/14","attributeName":"Product Category","classification_type":"PRODUCT_TYPE","updated":"Mon Oct 16 06:56:05 UTC 2017","status":"VERIFIED"},"values":[{"id":"home_and_garden","locale":"en_US","value":"Home & Garden","tag_source":"model_guess"}]},"ironbank_category":{"properties":{"attributeId":"-19436162","fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-689475a0-ccfa-4b36-8af2-8ff6c89ba6f4","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","taxonomy_version":"urn:taxonomy:pcs2.0","attributeName":"IronBank Category","source":"mp","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R","updated":"Fri Sep 22 05:28:44 UTC 2017","content_lifecycle_status":"ACTIVE"},"values":[{"idPath":"[\"office\",\"office_other\"]","charPath":"[\"Office\",\"Office\"]","isPrimary":"true","display_attr_name":"IronBank Category","locale":"en_US","value":"Office","source_key":"ironbank_category","source_value":"Office"}]}}, "day":"yesterday"}'   
        product_attributes2 = '{ "pcf" : {"all_rhids":{"properties":{"attributeId":"rhid","taxonomy_version":"~draft","attributeName":"Site Taxonomy","taxonomy":"rhid-dotcom","source":"BRAAVOS","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","status":"VERIFIED"},"values":[{"path_id":"[\"40000\",\"45000\",\"45004\",\"45121\",\"45365\"]","id":"45365","locale":"en_US","value":"OFFICE PRODUCTS AND SCHOOL SUPPLY MISC L5","tag_source":"rule","path_str":"[\"EVERYDAY LIVING\",\"OFFICE PRODUCTS AND SCHOOL SUPPLY\",\"OFFICE PRODUCTS AND SCHOOL SUPPLY MISC L2\",\"OFFICE PRODUCTS AND SCHOOL SUPPLY MISC L3\",\"OFFICE PRODUCTS AND SCHOOL SUPPLY MISC L4\"]"}]},"primary_shelf":{"properties":{"attributeId":"shelf","added":"Wed Nov 08 22:10:29 PST 2017","attributeName":"Primary Shelf","source":"BRAAVOS","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","status":"VERIFIED"},"values":[{"all_paths_str":"[[\"Home Page\",\"Home\",\"Decor\",\"Art & Wall Decor\",\"Wall Decor\"]]","path_id":"[\"0\",\"4044\",\"133012\",\"1045881\",\"922699\"]","all_paths_id":"[[\"0\",\"4044\",\"133012\",\"1045881\",\"922699\"]]","taxonomy_version":"~draft","id":"922699","taxonomy":"site-dotcom","locale":"en_US","value":"Wall Decor","tag_source":"normalization","path_str":"[\"Home Page\",\"Home\",\"Decor\",\"Art & Wall Decor\",\"Wall Decor\"]"}]},"alternate_shelves":{"properties":{"attributeId":"alternate_shelves","attributeName":"Alternate Shelves","source":"MARKETPLACE_PARTNER","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R"},"values":[{"isPrimary":"true","locale":"en_US","value":"922699"}]},"item_class_id":{"properties":{"attribute_type":"STRING","attributeName":"Item Class ID","source":"BRAAVOS","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9"},"values":[{"locale":"en_US","value":"1","tag_source":"rule"}]},"primary_category_path":{"properties":{"attributeId":"primary_category_path","attributeName":"Primary Category Path","source":"MARKETPLACE_PARTNER","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R"},"values":[{"isPrimary":"true","locale":"en_US","value":"0:4044:133012:1045881:922699"}]},"product_url_text":{"properties":{"fromPcp":"false","added":"Thu Nov 09 06:10:29 UTC 2017","isMultiValued":"false","taxonomy_version":"urn:taxonomy:pcs2.0","attribute_type":"STRING","source":"braavos","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","attributeId":"86412","requestId":"reingest1-dab1aa83-efd4-48ef-a282-7b7e88f4dbdf","org_id":"0ceec947-5172-46e4-8dc4-8e37b4ffde80","isMarketAttribute":"true","attributeName":"Product URL Text","updated":"Thu Nov 09 06:10:29 UTC 2017"},"values":[{"isPrimary":"true","display_attr_name":"url_text_key","locale":"en_US","value":"/ip/NMC-Signs-Dl76R-Hot-Dot-Placard-Sign-10-75-X-10-75-Rigid-Plastic-050/765417231","source_key":"url_text_key","source_value":"/ip/NMC-Signs-Dl76R-Hot-Dot-Placard-Sign-10-75-X-10-75-Rigid-Plastic-050/765417231"}]},"primary_shelf_id":{"properties":{"attributeId":"primary_shelf_id","attributeName":"Primary Shelf ID","source":"BRAAVOS","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9"},"values":[{"isPrimary":"true","locale":"en_US","value":"922699"}]},"char_primary_category_path":{"properties":{"attributeId":"char_primary_category_path","attributeName":"Character Primary Category Path","source":"MARKETPLACE_PARTNER","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R"},"values":[{"isPrimary":"true","locale":"en_US","value":"Home Page/Home/Decor/Art & Wall Decor/Wall Decor"}]},"product_long_description":{"properties":{"attributeId":"84122","fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-689475a0-ccfa-4b36-8af2-8ff6c89ba6f4","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","taxonomy_version":"urn:taxonomy:pcs2.0","attributeName":"Product Long Description","source":"mp","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R","updated":"Fri Sep 22 05:28:44 UTC 2017","content_lifecycle_status":"ACTIVE"},"values":[{"isPrimary":"true","display_attr_name":"Product Long Description","locale":"en_US","value":"<ul><li>MADE IN THE USA</li><li>Name:HOT DOT PLACARD SIGN</li><li>Height (In): 10.75</li><li>Width (In): 10.75</li><li>Material: RIGID PLASTIC .050</li><li>Legend: HOT</li></ul>","source_key":"long_description","source_value":"<ul><li>MADE IN THE USA</li><li>Name:HOT DOT PLACARD SIGN</li><li>Height (In): 10.75</li><li>Width (In): 10.75</li><li>Material: RIGID PLASTIC .050</li><li>Legend: HOT</li></ul>"}]},"wmt_category":{"properties":{"fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-dab1aa83-efd4-48ef-a282-7b7e88f4dbdf","org_id":"0ceec947-5172-46e4-8dc4-8e37b4ffde80","taxonomy_version":"urn:taxonomy:pcs2.0","attributeName":"WMT Category","source":"braavos","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","updated":"Thu Nov 09 06:10:29 UTC 2017","isFacet":"true"},"values":[{"isFacetValue":"true","locale":"en_US","value":"Wall_Decor"}]},"facet_product_type":{"properties":{"taxonomy_version":"urn:taxonomy:pcs2.0","attributeName":"Facet Product Type","source":"MARKETPLACE_PARTNER","isFacet":"true"},"values":[{"isFacetValue":"true","facet_version":"1.1","locale":"en_US","value":"Plaques & Signs"}]},"brand":{"properties":{"fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","taxonomy_version":"urn:taxonomy:pcs2.0","source":"mp","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R","multiselect":"N","attributeId":"10848","requestId":"reingest1-689475a0-ccfa-4b36-8af2-8ff6c89ba6f4","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","attributeName":"Brand","updated":"Fri Sep 22 05:28:44 UTC 2017","isFacet":"true","content_lifecycle_status":"ACTIVE"},"values":[{"isPrimary":"true","display_attr_name":"Brand","locale":"en_US","value":"NMC","source_key":"brand","source_value":"NMC"},{"isFacetValue":"true","facet_version":"1.1","locale":"en_US","value":"NMC"}]},"display_status":{"properties":{"attributeId":"94989","fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-689475a0-ccfa-4b36-8af2-8ff6c89ba6f4","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","taxonomy_version":"urn:taxonomy:pcs2.0","isMarketAttribute":"true","attributeName":"Display Status","source":"mp","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R","updated":"Fri Sep 22 05:28:44 UTC 2017","content_lifecycle_status":"ACTIVE"},"values":[{"isPrimary":"true","display_attr_name":"Display Status","locale":"en_US","value":"STAGING","source_key":"display_status","source_value":"STAGING"}]},"gtin":{"properties":{"multiselect":"N","attributeId":"-1","fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-dab1aa83-efd4-48ef-a282-7b7e88f4dbdf","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","taxonomy_version":"urn:taxonomy:pcs2.0","attributeName":"GTIN","source":"braavos","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","updated":"Thu Nov 09 06:10:29 UTC 2017","content_lifecycle_status":"ACTIVE","generated_from_matching":"true"},"values":[{"locale":"en_US","source_key":"gtin","value":"00887481042145","display_attr_name":"GTIN","source_value":"00887481042145","isPrimary":"true"}]},"rh_path":{"properties":{"attributeId":"94969","isMultiValued":"false","taxonomy_version":"version","isMarketAttribute":"true","attribute_type":"STRING","attributeName":"RH Path","taxonomy":"pcs","display_attr_name":"rh_path","source":"BRAAVOS","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9"},"values":[{"isPrimary":"true","display_attr_name":"rh_path","locale":"en_US","value":"40000:45000:45004:45121:45365"}]},"item_id":{"properties":{"attributeId":"-1","fromPcp":"false","generated_by":"Qarth","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-dab1aa83-efd4-48ef-a282-7b7e88f4dbdf","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","taxonomy_version":"urn:taxonomy:pcs2.0","attributeName":"ITEM_ID","source":"braavos","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","updated":"Thu Nov 09 06:10:29 UTC 2017","content_lifecycle_status":"ACTIVE","generated_from_matching":"true"},"values":[{"isPrimary":"true","display_attr_name":"ITEM_ID","locale":"en_US","value":"765417231","source_key":"item_id","source_value":"765417231"}]},"upc":{"properties":{"multiselect":"N","attributeId":"-1","fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-dab1aa83-efd4-48ef-a282-7b7e88f4dbdf","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","taxonomy_version":"urn:taxonomy:pcs2.0","attributeName":"UPC","source":"braavos","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","updated":"Thu Nov 09 06:10:29 UTC 2017","content_lifecycle_status":"ACTIVE","generated_from_matching":"true"},"values":[{"locale":"en_US","source_key":"upc","value":"887481042145","display_attr_name":"UPC","source_value":"887481042145","isPrimary":"true"}]},"product_pt_family":{"properties":{"added":"Thu Mar 16 11:59:24 UTC 2017","taxonomy_version":"~draft","taxonomy":"pcs","source":"braavos","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","orgId":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","attributeId":"product_pt_family","org_id":"0ceec947-5172-46e4-8dc4-8e37b4ffde80","requestId":"PIG-BF16B8FEBD1B4DE393CCEB1079FF51BB@ARABAQA/765417231/14","attributeName":"Product PT Family","classification_type":"PRODUCT_TYPE","updated":"Mon Oct 16 06:56:05 UTC 2017","status":"VERIFIED"},"values":[{"id":"home_decor_pcs","locale":"en_US","value":"Home Decor","tag_source":"model_guess"}]},"product_name":{"properties":{"multiselect":"N","attributeId":"84123","fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-689475a0-ccfa-4b36-8af2-8ff6c89ba6f4","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","taxonomy_version":"urn:taxonomy:pcs2.0","attributeName":"Product Name","source":"mp","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R","updated":"Fri Sep 22 05:28:44 UTC 2017","content_lifecycle_status":"ACTIVE"},"values":[{"isPrimary":"true","display_attr_name":"Product Name","locale":"en_US","value":"NMC Signs Dl76R, Hot Dot Placard Sign, 10.75 X 10.75, Rigid Plastic .050","source_key":"product_name","source_value":"NMC Signs Dl76R, Hot Dot Placard Sign, 10.75 X 10.75, Rigid Plastic .050"}]},"shelf_description":{"properties":{"fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","taxonomy_version":"urn:taxonomy:pcs2.0","source":"mp","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R","multiselect":"N","attributeId":"-2126304598","requestId":"reingest1-689475a0-ccfa-4b36-8af2-8ff6c89ba6f4","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","isMarketAttribute":"true","attributeName":"Shelf Description","updated":"Fri Sep 22 05:28:44 UTC 2017","content_lifecycle_status":"ACTIVE"},"values":[{"isPrimary":"true","display_attr_name":"Shelf Description","locale":"en_US","value":"<ul><li>Items ship from manufacturer in 2 days</li><li>Made in the USA</li><li>Hot Dot Placard Sign</li></ul>","source_key":"shelf_description","source_value":"<ul><li>Items ship from manufacturer in 2 days</li><li>Made in the USA</li><li>Hot Dot Placard Sign</li></ul>"}]},"product_tax_code":{"properties":{"fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","taxonomy_version":"urn:taxonomy:pcs2.0","source":"mp","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R","multiselect":"N","attributeId":"84126","isOfferAttribute":"true","requestId":"reingest1-689475a0-ccfa-4b36-8af2-8ff6c89ba6f4","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","attributeName":"Product Tax Code","updated":"Fri Sep 22 05:28:44 UTC 2017","content_lifecycle_status":"ACTIVE"},"values":[{"isPrimary":"true","display_attr_name":"Product Tax Code","locale":"en_US","value":"2038711","source_key":"product_tax_code","source_value":"2038711"}]},"condition":{"properties":{"multiselect":"N","attributeId":"10314","fromPcp":"false","added":"Fri Sep 22 17:06:12 UTC 2017","requestId":"reingest1-dab1aa83-efd4-48ef-a282-7b7e88f4dbdf","org_id":"0ceec947-5172-46e4-8dc4-8e37b4ffde80","taxonomy_version":"urn:taxonomy:pcs2.0","backfill":"true","attributeName":"Condition","source":"braavos","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","updated":"Thu Nov 09 06:10:29 UTC 2017"},"values":[{"locale":"en_US","source_key":"condition","value":"New","display_attr_name":"Condition","source_value":"New","tag_source":"model_predictions:ae2","isPrimary":"true"}]},"all_shelves":{"properties":{"attributeId":"shelf","added":"Wed Nov 08 22:10:29 PST 2017","rule_changed":"N","attributeName":"All Shelves","source":"BRAAVOS","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","status":"VERIFIED"},"values":[{"all_paths_str":"[[\"Home Page\",\"Home\",\"Decor\",\"Art & Wall Decor\",\"Wall Decor\"]]","path_id":"[\"0\",\"4044\",\"133012\",\"1045881\",\"922699\"]","all_paths_id":"[[\"0\",\"4044\",\"133012\",\"1045881\",\"922699\"]]","taxonomy_version":"~draft","id":"922699","taxonomy":"site-dotcom","locale":"en_US","value":"Wall Decor","tag_source":"normalization","path_str":"[\"Home Page\",\"Home\",\"Decor\",\"Art & Wall Decor\",\"Wall Decor\"]"}]},"product_type":{"properties":{"added":"Thu Mar 16 11:59:24 UTC 2017","taxonomy_version":"~draft","taxonomy":"pcs","source":"braavos","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","orgId":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","attributeId":"product_type","org_id":"0ceec947-5172-46e4-8dc4-8e37b4ffde80","requestId":"PIG-BF16B8FEBD1B4DE393CCEB1079FF51BB@ARABAQA/765417231/14","attributeName":"Product Type","classification_type":"PRODUCT_TYPE","updated":"Mon Oct 16 06:56:05 UTC 2017","status":"VERIFIED"},"values":[{"idPath":"[[\"home_and_garden\",\"home_decor_pcs\",\"1916\"]]","charPath":"[[\"Home & Garden\",\"Home Decor\",\"Plaques & Signs\"]]","id":"1916","locale":"en_US","value":"Plaques & Signs2","tag_source":"model_guess"}]},"material":{"properties":{"attributeId":"10312","fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-689475a0-ccfa-4b36-8af2-8ff6c89ba6f4","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","taxonomy_version":"urn:taxonomy:pcs2.0","attributeName":"Material","source":"mp","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R","updated":"Fri Sep 22 05:28:44 UTC 2017","content_lifecycle_status":"ACTIVE"},"values":[{"materialValue":"RIGID PLASTIC .050","isPrimary":"true","display_attr_name":"Material","locale":"en_US","value":"RIGID PLASTIC .050","source_key":"material","source_value":"RIGID PLASTIC .050"}]},"manufacturer_part_number":{"properties":{"multiselect":"N","attributeId":"10336","fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-689475a0-ccfa-4b36-8af2-8ff6c89ba6f4","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","taxonomy_version":"urn:taxonomy:pcs2.0","attributeName":"Manufacturer Part Number","source":"mp","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R","updated":"Fri Sep 22 05:28:44 UTC 2017","content_lifecycle_status":"ACTIVE"},"values":[{"isPrimary":"true","display_attr_name":"Manufacturer Part Number","locale":"en_US","value":"DL76R","source_key":"manufacturerpartnumber","source_value":"DL76R"}]},"offer_lifecycle_status":{"properties":{"fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-689475a0-ccfa-4b36-8af2-8ff6c89ba6f4","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","source":"mp","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R","updated":"Fri Sep 22 05:28:44 UTC 2017"},"values":[{"display_attr_name":"offer_lifecycle_status","locale":"en_US","value":"ACTIVE"}]},"product_short_description":{"properties":{"multiselect":"N","attributeId":"84128","fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-689475a0-ccfa-4b36-8af2-8ff6c89ba6f4","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","taxonomy_version":"urn:taxonomy:pcs2.0","attributeName":"Short Description","source":"mp","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R","updated":"Fri Sep 22 05:28:44 UTC 2017","content_lifecycle_status":"ACTIVE"},"values":[{"isPrimary":"true","display_attr_name":"Short Description","locale":"en_US","value":"Hot substances can cause serious burns when they come in contact with ones skin. Prevent an accident by labeling designated vehicles carrying hot substances with this placard sign.","source_key":"short_description","source_value":"Hot substances can cause serious burns when they come in contact with ones skin. Prevent an accident by labeling designated vehicles carrying hot substances with this placard sign."}]},"reporting_hierarchy":{"properties":{"attributeId":"rhid","taxonomy_version":"~draft","attributeName":"Site Taxonomy","taxonomy":"rhid-dotcom","source":"BRAAVOS","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","status":"VERIFIED"},"values":[{"is_updated":"false","path_id":"[\"40000\",\"45000\",\"45004\",\"45121\",\"45365\"]","id":"45365","locale":"en_US","value":"OFFICE PRODUCTS AND SCHOOL SUPPLY MISC L4","tag_source":"rule","path_str":"[\"EVERYDAY LIVING\",\"OFFICE PRODUCTS AND SCHOOL SUPPLY\",\"OFFICE PRODUCTS AND SCHOOL SUPPLY MISC L2\",\"OFFICE PRODUCTS AND SCHOOL SUPPLY MISC L3\",\"OFFICE PRODUCTS AND SCHOOL SUPPLY MISC L4\"]"}]},"product_category":{"properties":{"added":"Thu Mar 16 11:59:24 UTC 2017","taxonomy_version":"~draft","taxonomy":"pcs","source":"braavos","qid":"BRAAVOS#0ceec947-5172-46e4-8dc4-8e37b4ffde80#6HSK-TDWA-JEW9","orgId":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","attributeId":"segment","org_id":"0ceec947-5172-46e4-8dc4-8e37b4ffde80","requestId":"PIG-BF16B8FEBD1B4DE393CCEB1079FF51BB@ARABAQA/765417231/14","attributeName":"Product Category","classification_type":"PRODUCT_TYPE","updated":"Mon Oct 16 06:56:05 UTC 2017","status":"VERIFIED"},"values":[{"id":"home_and_garden","locale":"en_US","value":"Home & Garden","tag_source":"model_guess"}]},"ironbank_category":{"properties":{"attributeId":"-19436162","fromPcp":"false","added":"Thu Mar 16 11:59:24 UTC 2017","requestId":"reingest1-689475a0-ccfa-4b36-8af2-8ff6c89ba6f4","org_id":"9dd773f1-f59f-4c51-b6e2-08a313ed43b7","taxonomy_version":"urn:taxonomy:pcs2.0","attributeName":"IronBank Category","source":"mp","qid":"MARKETPLACE_PARTNER#9dd773f1-f59f-4c51-b6e2-08a313ed43b7#DL76R","updated":"Fri Sep 22 05:28:44 UTC 2017","content_lifecycle_status":"ACTIVE"},"values":[{"idPath":"[\"office\",\"office_other\"]","charPath":"[\"Office\",\"Office\"]","isPrimary":"true","display_attr_name":"IronBank Category","locale":"en_US","value":"Office","source_key":"ironbank_category","source_value":"Office"}]}}, "day":"today"}'   
        org_id = 'BRAAVOS'
        
        qpriority = "SET mapred.job.priority=VERY_HIGH;"
        ##drop and create table before inserts...
        query1 = ("INSERT INTO TABLE catint.temp2_product_attributes2D_test select * from (select '" + product_id + "','" + source + "','" + updated_at1 + "','" + 
                 product_attributes1 + "','" + org_id + "')S;")
        query2 = ("INSERT INTO TABLE catint.temp2_product_attributes2D_test select * from (select '" + product_id + "','" + source + "','" + updated_at2 + "','" + 
                 product_attributes2 + "','" + org_id + "')S;")
        self.execHiveCheck(qpriority + query1 + query2)
        
    def getUpdatesCreates(self):
        with open('counts1_all_rhids.out', 'r') as f:
            results = f.read()
            
        lines = results.split('\n')
        
        i = 0
        j = 0
        counter_creates = 0
        counter_updates = 0
        for line in lines:
            fields = line.split('@')
            if (len(fields) > 8):
                i = i + 1
                #print line
                counter_creates = counter_creates + len(fields[1]) 
                if len(fields[1]) > 2:
                    print fields[2]
            else:
                counter_updates += 1
    
        print counter_updates
        print counter_creates
        return (counter_updates, counter_creates)
        
    def getProductIds(self, fn, header, separator):
        product_ids = []
        with open(fn, 'r') as f:
            data_raw = f.read()
        lines = data_raw.split('\n')
        if header == True:
            lines = lines[1:]
        for line in lines:
            line_ = line.strip(separator)
            if line_ == '':
                continue
            fields = line_.split()
            product_ids.append(fields[0].strip())
        return product_ids
###################################################################################        
def run():
    pTADP = ProductTopAttributesDataPrep()
    #product_ids_lan = pTADP.getProductIds('product_top_attributes_data_validation_22_23_lan.txt', True, ' ')
    #product_ids_raj = pTADP.getProductIds('product_top_attributes_data_validation_22_23_raj.txt', False, '@')
    
    #product_ids_lan = pTADP.getProductIds('product_validate_22_23_pt.txt2', True, ' ')
    #product_ids_raj = pTADP.getProductIds('counts1_product_type.out', False, '@')
    
    product_ids_lan = pTADP.getProductIds('lhk_product_validate_13_14.rhid.txt', True, ' ')
    product_ids_raj = pTADP.getProductIds('counts1_all_rhids.out', False, '@')
    
#     product_ids_lan = pTADP.getProductIds('lhk_product_validate_22_23.sql.gender.txt', True, ' ')
#     product_ids_raj = pTADP.getProductIds('counts1_gender_new_udf.out', False, '@')
    print 'len(product_ids_lan): ', len(product_ids_lan)
    print 'len(product_ids_raj): ', len(product_ids_raj)
    
    diffs_lr = set(product_ids_lan) - set(product_ids_raj)
    diffs_rl = set(product_ids_raj) - set(product_ids_lan)
    print 'len(diffs_lr): ', len(diffs_lr)
    print 'len(diffs_rl): ', len(diffs_rl)
    
    print 'diffs_lr: ', list(diffs_lr)[0:5]
    sys.exit(1)
    print 'diffs_rl2: ', ',\n'.join(diffs_rl)
    print 'len(intersection: lan/raj): ', len(set(product_ids_lan).intersection(set(product_ids_raj)))
#     product_ids_good = '"'
#     product_ids_good += '","'.join(product_ids_raj)
#     product_ids_good += '"'
#     product_ids_bad = '"'
#     product_ids_bad += '","'.join(diffs_lr)
#     product_ids_bad += '"'
#     query_good = ('select product_id, LENGTH(product_attributes) from catint.temp2_product_attributes3 where product_id in ' +
#     '(' + product_ids_good + ');')
#     query_bad = ('select product_id, LENGTH(product_attributes) from catint.temp2_product_attributes3 where product_id in ' +
#     '(' + product_ids_bad + ');')

    print 'diffs:lan - raj ', list(diffs_lr)[0:5]
##################################################################################
if __name__ == "__main__":
    run()
#######################################################################################
#select product_attributes from catint.temp2_product_attributes where product_id in ('5NRON0LCEGDL', '6XP3Y90VCYQ0', '4U7JBBF4MC2F', '76BA7H01ZF1M', '4NBGCL5V557R');

#select * from (select '-----------------------------')S;

#select product_attributes from catint.temp2_product_attributes2 where product_id in ('5NRON0LCEGDL', '6XP3Y90VCYQ0', '4U7JBBF4MC2F', '76BA7H01ZF1M', '4NBGCL5V557R');
#######################################################################################
###Notes:  attributes validated so far:  all_rhids, product_name, wmt_category, gender, color, product_type



    